(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();class h{constructor(e,t){this.model=e,this.view=t,this.initialize()}initialize(){this.model.addObserver(this),this.view.setObserver(this),this.view.updateView(this.model.getState())}update(e){this.view.updateView(e)}onGameModeChange(e){this.model.setGameMode(e)}onPlayerMove(e){this.model.setPlayerMove(e)}onStartRound(){this.model.startRound()}onResetGame(){this.model.resetGame()}}var n=(s=>(s.HUMAN_VS_COMPUTER="HUMAN_VS_COMPUTER",s.COMPUTER_VS_COMPUTER="COMPUTER_VS_COMPUTER",s))(n||{}),a=(s=>(s.ROCK="ROCK",s.PAPER="PAPER",s.SCISSORS="SCISSORS",s))(a||{}),l=(s=>(s.PLAYER_1="Giocatore 1 Vince!",s.PLAYER_2="Giocatore 2 Vince!",s.DRAW="Pareggio!",s))(l||{});class c{constructor(){this.observers=[],this.rules=new Map([[a.ROCK,[a.SCISSORS]],[a.PAPER,[a.ROCK]],[a.SCISSORS,[a.PAPER]]]),this.state=this.getInitialState()}getState(){return Object.freeze(this.state)}setGameMode(e){this.state={...this.getState(),mode:e},this.notifyObservers()}resetGame(){this.state={...this.getInitialState(),mode:this.state.mode},this.notifyObservers()}startRound(){if(this.state.mode===n.COMPUTER_VS_COMPUTER){const t=this.generateRandomMove(),i=this.generateRandomMove(),r=this.calculateResult(t,i);this.state={...this.getState(),roundStarted:!0,player1Move:t,player2Move:i,result:r}}else this.state={...this.getState(),roundStarted:!0,player1Move:null,player2Move:null,result:null};this.notifyObservers()}setPlayerMove(e){if(!this.state.roundStarted)return;const t=this.state.mode===n.HUMAN_VS_COMPUTER?this.generateRandomMove():null,i=t?this.calculateResult(e,t):null;this.state={...this.getState(),player1Move:e,player2Move:t,result:i},this.notifyObservers()}addObserver(e){this.observers.push(e)}removeObserver(e){const t=this.observers.indexOf(e);t>-1&&this.observers.splice(t,1)}generateRandomMove(){const e=[a.ROCK,a.PAPER,a.SCISSORS],t=Math.floor(Math.random()*e.length);return e[t]}calculateResult(e,t){return e===t?l.DRAW:this.rules.get(e)?.includes(t)?l.PLAYER_1:l.PLAYER_2}notifyObservers(){this.observers.forEach(e=>e.update(this.getState()))}getInitialState(){return{mode:n.HUMAN_VS_COMPUTER,roundStarted:!1,player1Move:null,player2Move:null,result:null}}}class u{constructor(){this.observer=null,this.gameModeSelect=this.getElement("#game-mode"),this.startGameBtn=this.getElement("#start-btn"),this.player1Section=this.getElement("#player1-move"),this.player2Section=this.getElement("#player2-move"),this.player1Moves=this.player1Section.querySelectorAll(".move-btn"),this.player2Moves=this.player2Section.querySelectorAll(".move-btn"),this.result=this.getElement("#result"),this.resetBtn=this.getElement("#reset-btn"),this.setupEventListeners()}setObserver(e){this.observer=e}updateView(e){this.handleControls(e),this.handlePlayerMove(e),this.handleRoundComplete(e)}handleControls(e){e.roundStarted?(this.clearButtonState(),this.gameModeSelect.disabled=!0,this.startGameBtn.hidden=!0,this.player1Section.hidden=!1,this.player2Section.hidden=!1):(this.gameModeSelect.disabled=!1,this.player1Section.hidden=!0,this.player2Section.hidden=!0,this.startGameBtn.hidden=!1)}handlePlayerMove(e){this.player1Moves.forEach(t=>{const i=t.dataset.choice;e.roundStarted&&!e.player1Move?t.disabled=!1:t.disabled=!0,e.player1Move===i&&t.classList.add("selected")}),this.player2Moves.forEach(t=>{const i=t.dataset.choice;e.player2Move===i?t.classList.add("selected"):t.classList.remove("selected")})}handleRoundComplete(e){e.result?(this.result.hidden=!1,this.result.textContent=e.result,this.resetBtn.hidden=!1):(this.result.hidden=!0,this.resetBtn.hidden=!0)}setupEventListeners(){this.gameModeSelect.addEventListener("change",()=>{this.observer?.onGameModeChange(this.gameModeSelect.value)}),this.startGameBtn.addEventListener("click",()=>{this.observer?.onStartRound()}),this.player1Moves.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.choice?.toUpperCase();t&&this.observer&&this.observer.onPlayerMove(t)})}),this.resetBtn.addEventListener("click",()=>{this.clearButtonState(),this.observer?.onResetGame()})}clearButtonState(){this.player1Moves.forEach(e=>{e.classList.remove("selected")}),this.player2Moves.forEach(e=>{e.classList.remove("selected")})}getElement(e){const t=document.querySelector(e);if(!t)throw new Error(`Element with selector '${e}' not found`);return t}}const m=new c,v=new u;new h(m,v);
